---
title: Provider Service
description: ProviderService wraps a transport and exposes JSON-RPC request/response as Effect.
---

# Provider Service

`ProviderService` is the core service for JSON-RPC communication. It wraps a `TransportService` and exposes `request<T>(method, params)` returning `Effect<T, RpcError | TransportError>`.

Most users don't interact with `ProviderService` directly â€” use [JsonRpc](/effect/modules/jsonrpc) free functions or [ContractService](/effect/services/contract) instead.

## Imports

```typescript
import { Services } from "@kundera-sn/kundera-effect";
// or
import { ProviderService, ProviderLive, HttpProviderLive } from "@kundera-sn/kundera-effect/services";
```

## Service Shape

```typescript
interface ProviderServiceShape {
  readonly request: <T>(
    method: string,
    params?: readonly unknown[],
    options?: RequestOptions,
  ) => Effect.Effect<T, TransportError | RpcError>;
}
```

## Live Layers

| Layer | Dependencies | Description |
|-------|-------------|-------------|
| `ProviderLive` | `TransportService` | Wraps any transport into a provider |
| `HttpProviderLive(url, options?)` | None | HTTP transport + provider in one layer |
| `WebSocketProviderLive(url, options?)` | None | WebSocket transport + provider |
| `FallbackHttpProviderLive(endpoints)` | None | Multi-endpoint fallback provider |
| `FallbackHttpProviderFromUrls(...urls)` | None | Shorthand for URL-only fallback |

## Basic Usage

```typescript
import { Effect } from "effect";
import { Services, Presets } from "@kundera-sn/kundera-effect";

const program = Effect.gen(function* () {
  const provider = yield* Services.ProviderService;
  return yield* provider.request<string>({
    method: "starknet_chainId",
    params: [],
  });
}).pipe(
  Effect.provide(Presets.SepoliaProvider())
);
```

## Custom Provider

```typescript
import { Services } from "@kundera-sn/kundera-effect";

// HTTP with custom options
const provider = Services.HttpProviderLive("https://my-rpc.example.com", {
  timeout: 30_000,
  headers: { "x-api-key": "..." },
});

// Fallback across multiple endpoints
const fallback = Services.FallbackHttpProviderLive([
  { url: "https://primary.example.com", priority: 1 },
  { url: "https://secondary.example.com", priority: 2 },
]);

// Shorthand: URLs only, equal priority
const fallback2 = Services.FallbackHttpProviderFromUrls(
  "https://primary.example.com",
  "https://secondary.example.com",
);
```

## Error Handling

```typescript
import { Effect } from "effect";
import { RpcError, TransportError } from "@kundera-sn/kundera-effect/errors";

const program = Effect.gen(function* () {
  const provider = yield* Services.ProviderService;
  return yield* provider.request<number>("starknet_blockNumber", []);
}).pipe(
  Effect.catchTags({
    RpcError: (e) => Effect.succeed(-1),
    TransportError: (e) => Effect.succeed(-1),
  })
);
```

## Related

<CardGroup cols={2}>
  <Card title="Transport" icon="satellite" href="/effect/services/transport">
    Low-level transport configuration and interceptors.
  </Card>
  <Card title="JSON-RPC" icon="code" href="/effect/modules/jsonrpc">
    Free-function wrappers over ProviderService (preferred API).
  </Card>
  <Card title="RPC Batch" icon="layer-group" href="/effect/services/rpc-batch">
    Batch multiple RPC calls into a single HTTP request.
  </Card>
  <Card title="Presets" icon="sliders" href="/effect/modules/presets">
    Pre-composed provider layers for Mainnet, Sepolia, Devnet.
  </Card>
</CardGroup>
