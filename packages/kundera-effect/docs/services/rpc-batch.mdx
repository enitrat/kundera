---
title: RPC Batch Service
description: Batch JSON-RPC requests with queueing.
---

<Info>
RpcBatchService composes a transport and batches concurrent requests into JSON-RPC arrays.
</Info>

# RPC Batch Service

`RpcBatchService` queues calls and flushes them in a single request.

## Imports

```ts
import { Effect } from "effect";
import { Services } from "kundera-effect";
```

## Live Layer

- `Services.RpcBatch.RpcBatch(config)` (requires `TransportService`)

## Usage

```ts
const program = Effect.gen(function* () {
  const batch = yield* Services.RpcBatch.RpcBatchService;
  const [chainId, blockNumber] = yield* Effect.all([
    batch.request<string>("starknet_chainId"),
    batch.request<number>("starknet_blockNumber")
  ]);
  return { chainId, blockNumber };
}).pipe(
  Effect.provide(
    Services.Presets.createHttpProviderWithBatch(
      "https://starknet.example.com",
      { maxBatchSize: 20, maxWaitTime: 10 }
    )
  )
);
```

## Errors

`RpcBatchService` surfaces `TransportError` and `RpcError` on request failures.

## Related

<CardGroup cols={2}>
  <Card title="Provider" icon="plug" href="/services/provider">
    ProviderService and presets.
  </Card>
  <Card title="Transport" icon="satellite" href="/transport">
    Low-level transport Effects.
  </Card>
</CardGroup>
