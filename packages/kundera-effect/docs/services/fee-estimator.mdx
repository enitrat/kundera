---
title: Fee Estimator Service
description: Estimate transaction fees before submission.
---

# Fee Estimator Service

`FeeEstimatorService` estimates gas fees for transactions before they are submitted. It wraps `starknet_estimateFee` with proper transaction formatting.

## Imports

```typescript
import { Services } from "@kundera-sn/kundera-effect";
// or
import {
  FeeEstimatorService,
  FeeEstimatorLive,
} from "@kundera-sn/kundera-effect/services";
```

## Service Shape

```typescript
interface FeeEstimatorServiceShape {
  readonly estimateFee: (
    transactions: readonly EstimatableTransaction[],
    options?: FeeEstimateOptions,
  ) => Effect.Effect<FeeEstimate[], TransportError | RpcError>;
}
```

## Live Layer

`FeeEstimatorLive` requires `ProviderService` + `WalletProviderService`:

```typescript
// Included automatically in wallet stacks:
Presets.SepoliaWalletBaseStack({ swo })  // includes FeeEstimatorService
Presets.SepoliaWalletStack({ swo })      // includes FeeEstimatorService
```

## Estimate Fee

```typescript
import { Effect } from "effect";
import { Services, Presets } from "@kundera-sn/kundera-effect";

const program = Effect.gen(function* () {
  const feeEstimator = yield* Services.FeeEstimatorService;

  const [estimate] = yield* feeEstimator.estimateFee([
    {
      type: "INVOKE",
      sender_address: "0x...",
      calldata: ["0x...", "0x...", "0x..."],
      version: "0x3",
    },
  ]);

  return {
    gasConsumed: estimate.gas_consumed,
    gasPrice: estimate.gas_price,
    overallFee: estimate.overall_fee,
  };
});
```

## With Simulation Flags

```typescript
const [estimate] = yield* feeEstimator.estimateFee(
  [transaction],
  {
    blockId: "latest",
    simulationFlags: ["SKIP_VALIDATE"],
  }
);
```

## Related

<CardGroup cols={2}>
  <Card title="Account" icon="user" href="/effect/services/account">
    Account-level fee estimation with `estimateExecuteFee`.
  </Card>
  <Card title="Contract Write" icon="pen" href="/effect/services/contract-write">
    Contract-level fee estimation with `estimateFee`.
  </Card>
</CardGroup>
