---
title: JSON-RPC API
description: Tree-shakeable Starknet JSON-RPC methods with type-safe request builders.
---

<Info>
Source: [jsonrpc](https://github.com/enitrat/kundera/tree/main/packages/kundera-ts/src/jsonrpc)

Tests: [namespace.test.ts](https://github.com/enitrat/kundera/blob/main/packages/kundera-ts/src/jsonrpc/namespace.test.ts)
</Info>

# JSON-RPC API

Kundera exposes Starknet JSON-RPC methods as individual, tree-shakeable request builders with full TypeScript support.

<Tip>
New to Kundera? Start with [Getting Started](/getting-started/quickstart) for installation and your first requests.
</Tip>

## Overview

Build type-safe JSON-RPC requests and send them through any provider:

```typescript
import { HttpProvider } from '@kundera-sn/kundera-ts/provider';
import { Rpc } from '@kundera-sn/kundera-ts/jsonrpc';

const provider = new HttpProvider('https://api.zan.top/public/starknet-sepolia');

const blockNumber = await provider.request(Rpc.BlockNumberRequest());
const nonce = await provider.request(Rpc.GetNonceRequest('latest', '0x123...'));
```

## Request Builders

Request builders return `RequestArguments` objects compatible with any provider:

```typescript
import { Rpc } from '@kundera-sn/kundera-ts/jsonrpc';

// Build requests
const blockReq = Rpc.BlockNumberRequest();
// { method: "starknet_blockNumber", params: [] }

const nonceReq = Rpc.GetNonceRequest('latest', '0x123...');
// { method: "starknet_getNonce", params: ["latest", "0x123..."] }

// Send through provider
const blockNumber = await provider.request(blockReq);
```

### Request Pattern

All request builders follow this signature:

```typescript
Rpc.MethodNameRequest(params) -> RequestArguments
```

- **`Rpc.MethodName`** - Request builder (e.g., `BlockNumberRequest`, `GetNonceRequest`)
- **`params`** - Method-specific parameters
- **Returns** - `{method: string, params?: unknown[]}` object

## Method Categories

### Read Methods

Query blockchain state without creating transactions.

```typescript
import { Rpc } from '@kundera-sn/kundera-ts/jsonrpc';

// Block number
const block = await provider.request(Rpc.BlockNumberRequest());

// Nonce
const nonce = await provider.request(Rpc.GetNonceRequest('latest', contractAddress));
```

### Block Methods

```typescript
// Block with transaction hashes
const blockWithHashes = await provider.request(Rpc.GetBlockWithTxHashesRequest('latest'));
```

### Transaction Methods

```typescript
// Get transaction by hash
const tx = await provider.request(Rpc.GetTransactionByHashRequest(txHash));

// Submit invoke transaction
const { transaction_hash } = await provider.request(Rpc.AddInvokeTransactionRequest(invokeTx));
```

### Contract Methods

```typescript
// Call contract (read-only)
const result = await provider.request(Rpc.CallRequest({
  contract_address: contractAddress,
  entry_point_selector: selectorHash,
  calldata: ['0x1', '0x2']
}, 'latest'));
```

### Fee Estimation

```typescript
const estimates = await provider.request(Rpc.EstimateFeeRequest(
  [invokeTx],
  [],  // simulation flags
  'latest'
));
```

### Event Methods

```typescript
const { events, continuation_token } = await provider.request(Rpc.GetEventsRequest({
  filter: {
    from_block: { block_number: 100000 },
    to_block: 'latest',
    address: contractAddress,
    keys: [[eventKey]],
    chunk_size: 100
  }
}));
```

### Trace Methods

```typescript
const trace = await provider.request(Rpc.TraceTransactionRequest(txHash));
```

### Subscription Methods (WebSocket)

Real-time subscriptions require WebSocket transport.

```typescript
import { WebSocketProvider } from '@kundera-sn/kundera-ts/provider';

const ws = new WebSocketProvider('wss://api.zan.top/public/starknet-sepolia');
await ws.connect();

// Subscribe to new block headers
const subscriptionId = await ws.request(Rpc.SubscribeNewHeadsRequest());
```

## Domain Primitives

RPC responses return raw hex strings. Use domain primitive codecs to convert to branded types:

```typescript
import { Rpc } from '@kundera-sn/kundera-ts/jsonrpc';
import { blockHeaderFromRpc } from '@kundera-sn/kundera-ts/BlockHeader';
import { transactionFromRpc } from '@kundera-sn/kundera-ts/Transaction';
import { receiptFromRpc } from '@kundera-sn/kundera-ts/Receipt';

// Fetch raw wire-format response
const rawBlock = await provider.request(Rpc.GetBlockWithTxHashesRequest('latest'));

// Convert to branded domain types
const header = blockHeaderFromRpc(rawBlock);
// header.block_hash is Felt252Type, not string

const rawTx = await provider.request(Rpc.GetTransactionByHashRequest(txHash));
const tx = transactionFromRpc(rawTx);
// tx.sender_address is ContractAddressType
```

See [Domain Primitives](/typescript/primitives/domain-primitives) for the full codec reference.

## Error Handling

All methods can throw JSON-RPC errors:

```typescript
import { isJsonRpcError } from '@kundera-sn/kundera-ts/transport';

try {
  const result = await provider.request(Rpc.CallRequest(params, 'latest'));
} catch (error) {
  if (isJsonRpcError(error)) {
    console.error('RPC Error:', error.code, error.message);
    // Common codes:
    // -32601: Method not found
    // -32602: Invalid params
    // 20: Contract not found
    // 21: Block not found
    // 29: Transaction execution error
  }
}
```

## Batching

Use `requestBatch` for multiple independent requests:

```typescript
import { createRequest } from '@kundera-sn/kundera-ts/transport';

const responses = await transport.requestBatch([
  createRequest('starknet_blockNumber', []),
  createRequest('starknet_chainId', []),
  createRequest('starknet_getNonce', ['latest', address])
]);

const [blockNumber, chainId, nonce] = responses.map(r =>
  isJsonRpcError(r) ? null : r.result
);
```

For automatic batching, use the HTTP Transport skill:

```typescript
import { httpTransport } from './skills/http-transport';

const transport = httpTransport('https://...', {
  batch: { batchWait: 10, batchSize: 50 }
});

// Concurrent requests are automatically batched
const [block, chain, nonce] = await Promise.all([
  provider.request(Rpc.BlockNumberRequest()),
  provider.request(Rpc.ChainIdRequest()),
  provider.request(Rpc.GetNonceRequest('latest', address))
]);
```

## Type Safety

All methods have full TypeScript inference:

```typescript
import { Rpc } from '@kundera-sn/kundera-ts/jsonrpc';

// TypeScript knows the return type
const receipt = await provider.request(Rpc.GetTransactionReceiptRequest(txHash));

// Method params are type-checked
const callRequest = Rpc.CallRequest({
  contract_address: '0x...',
  entry_point_selector: '0x...',
  calldata: ['0x1', '0x2']
}, 'latest');
```

## Complete Method Reference

| Category | Methods |
|----------|---------|
| **Read** | `blockNumber`, `blockHashAndNumber`, `chainId`, `specVersion`, `syncing` |
| **Block** | `getBlockWithTxHashes`, `getBlockWithTxs`, `getBlockWithReceipts`, `getBlockTransactionCount`, `getStateUpdate` |
| **Transaction** | `getTransactionByHash`, `getTransactionByBlockIdAndIndex`, `getTransactionReceipt`, `getTransactionStatus`, `getMessagesStatus` |
| **Submit** | `addInvokeTransaction`, `addDeclareTransaction`, `addDeployAccountTransaction` |
| **Contract** | `call`, `getClass`, `getClassAt`, `getClassHashAt`, `getStorageAt`, `getNonce` |
| **Fee** | `estimateFee`, `estimateMessageFee` |
| **Events** | `getEvents` |
| **Trace** | `traceTransaction`, `traceBlockTransactions`, `simulateTransactions` |
| **Proof** | `getStorageProof` |
| **Subscribe** | `subscribeNewHeads`, `subscribeEvents`, `subscribeTransactionStatus`, `subscribeNewTransactions`, `subscribeNewTransactionReceipts`, `unsubscribe` |

## Tree-Shaking

Import only what you need for optimal bundle size:

```typescript
// Import namespace for request builders
import { Rpc } from '@kundera-sn/kundera-ts/jsonrpc';
```

<Tip>
Unused methods are excluded from your bundle when using a bundler with tree-shaking support.
</Tip>

## Related

<CardGroup cols={2}>
  <Card title="Provider API" icon="plug" href="/typescript/api/provider">
    Higher-level provider interface with typed methods.
  </Card>
  <Card title="Transport API" icon="satellite" href="/typescript/api/transport">
    Low-level transport layer for JSON-RPC communication.
  </Card>
  <Card title="Domain Primitives" icon="cube" href="/typescript/primitives/domain-primitives">
    Convert wire-format responses to branded domain types.
  </Card>
  <Card title="HTTP Provider Skill" icon="server" href="/typescript/skills/http-provider">
    Copy-paste provider implementation.
  </Card>
</CardGroup>
