---
title: Safe Starknet
description: Modern type safety with branded types
---

Kundera provides runtime safety without third-party validation libraries. Every primitive validates at construction, giving you type-safe, runtime-verified values.

## The Problem

### Type Confusion

Starknet uses 252-bit field elements for everything—addresses, class hashes, storage keys. They're all the same size, but mixing them is a bug.

TypeScript's structural typing means types with the same structure are interchangeable:

```typescript
type ContractAddress = `0x${string}`;
type ClassHash = `0x${string}`;

function deployContract(classHash: ClassHash, address: ContractAddress) { }

const address: ContractAddress = "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7";
const classHash: ClassHash = "0x052c7f38c1b29c15bdb4e7f6d6e2d6e4e5f6e7f8e9f0f1f2f3f4f5f6f7f8f9fa";

// Arguments swapped - compiles fine, breaks at runtime!
deployContract(address, classHash); // ✓ No error
```

### Casing Bugs

String-based addresses have casing inconsistencies:

```typescript
const addr1 = "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7"; // lowercase
const addr2 = "0x049D36570D4E46F48E99674BD3FCC84644DDD6B96F7C741B1562B82F9E004DC7"; // uppercase
addr1 === addr2; // false - same address!
```

## The Solution

[Branded types](https://prosopo.io/blog/typescript-branding/) add compile-time tags that prevent mixing incompatible types:

```typescript
import { ContractAddress, ClassHash } from '@kundera-sn/kundera-ts';

function deployContract(classHash: ClassHash, address: ContractAddress) { }

const address = ContractAddress('0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7')
const classHash = ClassHash('0x052c7f38c1b29c15bdb4e7f6d6e2d6e4e5f6e7f8e9f0f1f2f3f4f5f6f7f8f9fa')

deployContract(address, classHash)
// Error: Type 'ContractAddress' is not assignable to type 'ClassHash'
```

For casing, Kundera normalizes addresses internally:

```typescript
const addr1 = ContractAddress('0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7')
const addr2 = ContractAddress('0x049D36570D4E46F48E99674BD3FCC84644DDD6B96F7C741B1562B82F9E004DC7')
addr1.equals(addr2) // true
```

## Validation at Construction

Invalid inputs throw immediately:

```typescript
ContractAddress('0xnot_valid_hex')     // Error: Invalid hex character
ContractAddress('0x123')               // Error: Invalid address length
ContractAddress('invalid')             // Error: Must start with 0x
```

<Warning>
**If you see a branded type, it's validated.** Any `ContractAddress` value is guaranteed valid.
</Warning>

## All Primitives Are Branded

Kundera brands all Starknet primitives:

| Type | What it prevents |
|------|------------------|
| `Felt252` | Generic felt mixups |
| `ContractAddress` | Address used as class hash |
| `ClassHash` | Class hash used as address |
| `StorageKey` | Storage key used as address |
| `TransactionHash` | Transaction hash mixups |

```typescript
import { ContractAddress, ClassHash, StorageKey } from '@kundera-sn/kundera-ts';

const addr = ContractAddress('0x...');
const hash = ClassHash('0x...');
const key = StorageKey('0x...');

// TypeScript prevents all cross-type usage
function readStorage(contract: ContractAddress, slot: StorageKey) { }

readStorage(addr, hash);  // Error: ClassHash not assignable to StorageKey
readStorage(hash, key);   // Error: ClassHash not assignable to ContractAddress
```

## Benefits

<CardGroup cols={2}>
  <Card title="Type Safety" icon="lock">
    Can't mix ContractAddress with ClassHash or StorageKey
  </Card>
  <Card title="Zero Runtime Cost" icon="gauge">
    Brand only exists in TypeScript's type checker
  </Card>
  <Card title="LLM-Friendly" icon="robot">
    Compile errors help AI assistants self-correct
  </Card>
  <Card title="No Zod Needed" icon="shield-check">
    Validation built into constructors
  </Card>
</CardGroup>

## Learn More

<CardGroup cols={2}>
  <Card title="Primitives API" icon="cube" href="/api/primitives">
    Complete primitives reference
  </Card>
  <Card title="Architecture" icon="sitemap" href="/overview/architecture">
    How modules fit together
  </Card>
</CardGroup>
