---
title: Effect Transport
description: HTTP and WebSocket transports with typed errors
---

# Effect Transport

Transport operations return `Effect<T, TransportError>`.

## HTTP Transport

```typescript
import * as Transport from 'kundera-effect/transport';

const transport = Transport.httpTransport({
  url: 'https://starknet-mainnet.public.blastapi.io',
  headers: { 'Authorization': 'Bearer ...' },
  timeout: 30000
});
```

## WebSocket Transport

```typescript
const ws = Transport.webSocketTransport({
  url: 'wss://starknet-mainnet.public.blastapi.io/ws'
});

// Connect/disconnect
yield* Transport.connect(ws);
yield* Transport.disconnect(ws);
```

## Making Requests

```typescript
import { Effect } from 'effect';
import * as Transport from 'kundera-effect/transport';

const program = Effect.gen(function* () {
  // Single request
  const response = yield* Transport.request(
    transport,
    Transport.createRequest('starknet_blockNumber', [])
  );

  // Batch request
  const responses = yield* Transport.requestBatch(transport, [
    Transport.createRequest('starknet_blockNumber', []),
    Transport.createRequest('starknet_chainId', [])
  ]);

  return { response, responses };
});
```

## Utilities

```typescript
// Create JSON-RPC request
const request = Transport.createRequest('starknet_call', [params, 'latest']);

// Check for error response
if (Transport.isJsonRpcError(response)) {
  console.log(response.error.code);
  console.log(response.error.message);
}

// Match batch responses
const matched = Transport.matchBatchResponses(requests, responses);
```

## Error Handling

```typescript
const program = Transport.request(transport, request).pipe(
  Effect.retry({ times: 3 }),
  Effect.catchTag('TransportError', (e) => {
    console.log(e.operation); // "request"
    console.log(e.message);   // Network error details
    return Effect.fail(e);
  })
);
```
